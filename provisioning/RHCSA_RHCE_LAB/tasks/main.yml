---
- name: "Install 'Server With GUI' environment group"
  yum:
    name="@^Server With GUI"
    state="present"

- name: "Add user account & set its password"
  user:
    name="{{ default_user_name }}"
    groups="wheel"
    password="{{ defaul_user_password }}"
    update_password="always"

- name: "change root password"
  user:
    name="root"
    password="{{ root_user_password }}"
    update_password="always"

- name: "Add PEERDNS=no option"
  lineinfile:
    dest="/etc/sysconfig/network-scripts/ifcfg-{{ item }}"
    line="PEERDNS=no"
  with_items: "{{ network_interfaces }}"
  notify: restart network

- name: "Set primary & secondary DNS in network interface conf file"
  blockinfile:
    dest: "/etc/sysconfig/network-scripts/ifcfg-{{ item }}"
    insertafter: "PEERDNS=no"
    block: |
      DNS1={{ primary_dns }}
      DNS2={{ secondary_dns }}
  with_items: "{{ network_interfaces }}"
  notify: restart network
